labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
resLFC_Location_CCC_vs_nursery_annotated %>%
filter(padj < 0.05 & log2FoldChange > 1)
resLFC_Location_CCC_vs_nursery_annotated %>%
filter(padj < 0.05 & log2FoldChange <= -1)
load("Rdata_files/pvals.RData")
resLFC_Location_CCC_vs_nursery_annotated <- as.data.frame(resLFC) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "bioinformatics/Acervicornis_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
resLFC_Location_CCC_vs_nursery_annotated <- as.data.frame(resLFC) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "1_bioinformatics/Acervicornis_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
str(resLFC_Location_CCC_vs_nursery_annotated) #21814 x 7
resLFC_Location_CCC_vs_nursery_annotated %>%
filter(padj < 0.05 & log2FoldChange <= -1)
resLFC_Location_CCC_vs_nursery_annotated %>%
filter(padj < 0.05 & log2FoldChange >= 1)
load(file = "RData_files/networkdata_signed.RData")
load(file = "RData_files/wgcnaData.RData");
traits <- read_csv("4_WGCNA/traits.csv")
library(tidyverse)
traits <- read_csv("4_WGCNA/traits.csv")
nGenes = ncol(datt); #18192
nSamples = nrow(datt); #11
# Recalculate MEs with color labels
MEs0 = moduleEigengenes(datt, moduleColors)$eigengenes
library(tidyverse)
library(WGCNA)
library(flashClust)
library(ape)
options(stringsAsFactors=FALSE)
allowWGCNAThreads()
nGenes = ncol(datt); #18192
nSamples = nrow(datt); #11
# Recalculate MEs with color labels
MEs0 = moduleEigengenes(datt, moduleColors)$eigengenes
MEs = orderMEs(MEs0)
# correlations of genes with eigengenes
moduleGeneCor=cor(MEs,datt)
moduleGenePvalue = corPvalueStudent(moduleGeneCor, nSamples);
moduleGenePvalue
moduleTraitCor = cor(MEs, traits, use = "p");
moduleTraitPvalue = corPvalueStudent(moduleTraitCor, nSamples);
moduleTraitPvalue
textMatrix = paste(signif(moduleTraitCor, 2), "\n(",
signif(moduleTraitPvalue, 1), ")", sep = "");
dim(textMatrix) = dim(moduleTraitCor)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(
Matrix = moduleTraitCor,
xLabels = names(traits),
yLabels = names(MEs),
ySymbols = names(MEs),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.5,
zlim = c(-1, 1),
main = paste("Module-trait relationships")
)
# Display the correlation values within a heatmap plot
labeledHeatmap(
Matrix = moduleTraitCor,
xLabels = names(traits),
yLabels = names(MEs),
ySymbols = names(MEs),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.5,
zlim = c(-1, 1),
main = paste("Module-trait relationships")
)
par(mar = c(6, 8.5, 3, 3));
# Display the correlation values within a heatmap plot
labeledHeatmap(
Matrix = moduleTraitCor,
xLabels = names(traits),
yLabels = names(MEs),
ySymbols = names(MEs),
colorLabels = FALSE,
colors = blueWhiteRed(50),
textMatrix = textMatrix,
setStdMargins = FALSE,
cex.text = 0.5,
zlim = c(-1, 1),
main = paste("Module-trait relationships")
)
# run for each of these statements individually
whichTrait="CCC"
load(file = "networkdata_signed.RData")
hubgenes <- chooseTopHubInEachModule(datt, moduleColors, omitColors = "grey",
power = 2,
type = "signed")
hubgenes
hubgenes <-data.frame(hubgenes)
hubgenes <- tibble::rownames_to_column(hubgenes, "module")
hubgenes
MEs
# Correlation between two module eigengenes
cor_result <- cor.test(MEs$MEmediumpurple3, MEs$MEmagenta, method="pearson")
MEmediumpurple3
MEs
# Correlation between two module eigengenes
cor_result <- cor.test(MEs$MEmediumpurple3, MEs$MEmagenta, method="pearson")
View(hubgenes)
View(MEs)
# Correlation between two module eigengenes
# Check the structure of your MEs object
str(MEs)
# Convert to data frame if needed
MEs <- as.data.frame(MEs)
cor_result <- cor.test(MEs$MEmediumpurple3, MEs$MEmagenta, method="pearson")
MEs
# Convert to data frame if needed
MEs <- as.data.frame(MEs)
# Correlation between two module eigengenes
# Check the structure of your MEs object
str(MEs)
cor_result <- cor.test(MEs$MEmediumpurple3, MEs$MEmagenta, method="pearson")
MEs
cor_result <- cor.test(MEs$MEmediumpurple3, MEs$MEdarkmagenta, method="pearson")
# Summary stats
summary_stats <- data.frame(
Module = c("Mediumpurple3", "Darkmagentca"),
N_genes = c(sum(moduleColors=="mediumpurple3"), sum(moduleColors=="darkmagenta")),
Mean_expression = c(mean(MEs$MEmediumpurple3), mean(MEs$MEdarkmagenta)),
SD = c(sd(MEs$MEmediumpurple3), sd(MEs$MEdarkmagenta))
)
summary_stats
cor_result
# Or using your design
t.test(MEs$MEmediumpurple3 ~ Location)
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location)
load("Rdata_files/initial_fullddsdesigncountsVsdcounts.RData")
design %>%
rownames_to_column(var="Sample_ID") %>%
filter(!Sample_ID == "Acer_1099") -> design
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location)
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location) %>%
pivot_longer(MEdarkmagenta:MEmediumpurple3, names_to = "module", values_to = "collective_expression_level")
#plotting eigengene expression
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location) %>%
pivot_longer(MEdarkmagenta:MEmediumpurple3, names_to = "module", values_to = "collective_expression_level") %>%
ggplot(.,aes(x = Location, y = collective_expression_level,fill = Location)) +
geom_boxplot(width = 0.2) +
facet_wrap(~module, ncol = 1) +
theme_classic() +
scale_fill_manual(values = c("darkblue", "orange"))
# stats
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location) -> ME_stats
# Darkmagenta module
t_test_dark <- t.test(ME_stats$MEdarkmagenta ~ location)
ME_stats
# Darkmagenta module
t_test_dark <- t.test(ME_stats$MEdarkmagenta ~ Location)
# Darkmagenta module
t_test_dark <- t.test(ME_stats$MEdarkmagenta ~ Location)
# Darkmagenta module
t_test_dark <- t.test(ME_stats$MEdarkmagenta ~ ME_stats$Location)
t_test_dark
# Mediumpurple3 module
t_test_purple <- t.test(ME_stats$MEdarkmagenta ~ ME_stats$Location)
t_test_purple
# Mediumpurple3 module
t_test_purple <- t.test(ME_stats$MEmediumpurple3 ~ ME_stats$Location)
t_test_purple
MEs
whichTrait="CCC"
nGenes = ncol(datt);
nSamples = nrow(datt);
selTrait = as.data.frame(traits[,whichTrait]);
names(selTrait) = whichTrait
# names (colors) of the modules
modNames = substring(names(MEs), 3)
geneModuleMembership = as.data.frame(signedKME(datt, MEs));
MMPvalue = as.data.frame(corPvalueStudent(as.matrix(geneModuleMembership), nSamples));
names(geneModuleMembership) = paste("MM", modNames, sep="");
names(MMPvalue) = paste("p.MM", modNames, sep="");
geneTraitSignificance = as.data.frame(cor(datt, selTrait, use = "p"));
GSPvalue = as.data.frame(corPvalueStudent(as.matrix(geneTraitSignificance), nSamples));
names(geneTraitSignificance) = paste("GS.", names(selTrait), sep="");
names(GSPvalue) = paste("p.GS.", names(selTrait), sep="");
rownames_to_column(geneTraitSignificance, var="Locus") -> geneTraitSignificance
rownames_to_column(geneModuleMembership, var="Locus") -> geneModuleMembership
geneModuleMembership
merged_GS_MM <- inner_join(geneTraitSignificance, geneModuleMembership, by = "Locus")
merged_GS_MM
merged_GS_MM %>%
tidyr::gather(module, module_membership, MMdarkturquoise:MMgrey) %>%
filter(module== "MMdarkmagenta" | module == "MMmediumpurple3") %>%
ggplot(aes(module_membership, GS.CCC, color = module)) +
geom_point(size = 2, alpha = 1/100) +
geom_smooth(color="black", method = lm, se = T, fill = "grey") +
theme_classic() +
ylim(c(-1,1)) +
xlim(c(-1,1)) +
facet_wrap(~module, scales = "free") +
scale_color_manual(values = c("darkmagenta", "mediumpurple")) +
theme(legend.position = "none") +
labs(x="Module Membership",
y="Gene Significance for Coral City Camera")
merged_GS_MM %>%
tidyr::gather(module, module_membership, MMdarkturquoise:MMgrey) %>%
filter(module== "MMdarkmagenta" | module == "MMmediumpurple3")
traits
#plotting eigengene expression
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location) %>%
pivot_longer(MEdarkmagenta:MEmediumpurple3, names_to = "module", values_to = "collective_expression_level") %>%
ggplot(.,aes(x = Location, y = collective_expression_level,fill = Location)) +
geom_boxplot(width = 0.2) +
facet_wrap(~module, ncol = 1) +
theme_classic() +
scale_fill_manual(values = c("darkblue", "orange"))
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location)
#plotting eigengene expression
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location) %>%
pivot_longer(MEdarkmagenta:MEmediumpurple3, names_to = "module", values_to = "collective_expression_level") %>%
ggplot(.,aes(x = Location, y = collective_expression_level,fill = Location)) +
geom_point(width = 0.2) +
facet_wrap(~module, ncol = 1) +
theme_classic() +
scale_fill_manual(values = c("darkblue", "orange"))
#plotting eigengene expression
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location) %>%
pivot_longer(MEdarkmagenta:MEmediumpurple3, names_to = "module", values_to = "collective_expression_level") %>%
ggplot(.,aes(x = Location, y = collective_expression_level,fill = Location)) +
geom_point(width = 0.2) +
facet_wrap(~module, ncol = 1) +
theme_classic() +
scale_fill_manual(values = c("darkblue", "orange"))
#plotting eigengene expression
MEs %>%
tibble::rownames_to_column("accession_code") %>%
dplyr::inner_join(design %>%
dplyr::select(Sample_ID, Location),
by = c("accession_code" = "Sample_ID")) %>%
select(accession_code, MEdarkmagenta, MEmediumpurple3, Location) %>%
pivot_longer(MEdarkmagenta:MEmediumpurple3, names_to = "module", values_to = "collective_expression_level") %>%
ggplot(.,aes(x = Location, y = collective_expression_level,fill = Location)) +
geom_boxplot(width = 0.2) +
facet_wrap(~module, ncol = 1) +
theme_classic() +
scale_fill_manual(values = c("darkblue", "orange"))
# Darkmagenta module
t_test_dark <- t.test(ME_stats$MEdarkmagenta ~ ME_stats$Location)
t_test_dark
# Mediumpurple3 module
t_test_purple <- t.test(ME_stats$MEmediumpurple3 ~ ME_stats$Location)
t_test_purple
library(tidyverse)
library(readxl)
cures_frame_tilt_temp <- read_excel("raw_data/Oct2020_Jan2022_1901102_urban-2020-10_(0)_Temperature.xlsx", sheet = "1901102_urban-2020-10_(0)_Tempe")
#logged every 15 min
#edit cures frame time
cures_frame_tilt_temp$Datetime <- as.POSIXct(cures_frame_tilt_temp$Datetime, tz="UTC")
cures_frame_tilt_temp$Datetime_EST <- with_tz(cures_frame_tilt_temp$Datetime, "America/New_York")
# Filter the data to select time points at 2-hour intervals
cures_frame_tilt_temp <- cures_frame_tilt_temp %>%
filter(minute(Datetime_EST) == 0 & (hour(Datetime_EST) %% 2 == 0))
cures_frame_tilt_temp %>%
mutate(site = "CCC") %>%
dplyr::select(!Date:Datetime) %>%
dplyr::rename(Temperature = `Temperature (C)`) -> cures_frame_tilt_temp
# split date and time into two columns
cures_frame_tilt_temp %>%
tidyr::separate(Datetime_EST, c("Date", "Time"), sep = "\\ ", remove = FALSE) %>%
mutate(Date = as.Date(Date), Time = format(Datetime_EST, format = "%H:%M:%S")) -> cures_frame_tilt_temp
cures_frame_tilt_temp %>%
mutate(Time_period = hms(Time)) -> cures_frame_tilt_temp
max(cures_frame_tilt_temp$Datetime_EST) #"2022-02-01 12:00:00 EST"
min(cures_frame_tilt_temp$Datetime_EST) #"2020-10-12 20:00:00 EDT"
ggplot(cures_frame_tilt_temp, aes(x=Date, y=Temperature)) +
geom_point()
# trim off the first and last day because those include time points before the instrument was in the water
cures_frame_tilt_temp %>%
filter(Date > "2021-06-01" & Date < "2021-12-01") -> CCC_temp_2021_06_01
CCC_temp_2021_06_01 %>%
group_by(Date) %>%
summarise(mean_daily_temp = mean(Temperature), sd_daily_temp = sd(Temperature), daily_range = (max(Temperature)-min(Temperature))) %>%
ggplot(., aes(x=Date, y=mean_daily_temp)) +
geom_ribbon(aes(ymin = mean_daily_temp - sd_daily_temp, ymax = mean_daily_temp + sd_daily_temp), fill = "grey70") +
geom_line() +
theme_bw()
# trim off the first and last days because those include time points before the HOBO was in the water
KB_05282021 <- read_csv("raw_data/KBNursery_2021_05_28.csv", skip = 1)
KB_05282021 %>%
mutate(Datetime_EST=with_tz(mdy_hms(`Date Time, GMT-04:00`, tz = "Etc/GMT+4"), tzone = "Etc/GMT+4")) %>%
mutate(Datetime_EST=with_tz(Datetime_EST, tzone = "America/New_York")) %>%
dplyr::rename(Temperature = `Temp, °C (LGR S/N: 21085862, SEN S/N: 21085862)`) %>%
dplyr::select(Temperature, Datetime_EST) %>%
filter(Datetime_EST > "2021-05-29 01:00:00" & Datetime_EST < "2021-08-11 11:00:00") %>%
mutate(Light = NA) -> KB_05282021
KB_08112021 <- read_csv("raw_data/KBNursery_2021_08_11.csv", skip = 1)
KB_08112021 %>%
mutate(Datetime_EST=with_tz(mdy_hm(`Date Time, GMT-04:00`, tz = "Etc/GMT+4"), tzone = "Etc/GMT+4")) %>%
mutate(Datetime_EST=with_tz(Datetime_EST, tzone = "America/New_York")) %>%
dplyr::rename(Temperature = `Temp, °C (LGR S/N: 20831178, SEN S/N: 20831178)`) %>%
dplyr::rename(Light = `Intensity, lum/ft² (LGR S/N: 20831178, SEN S/N: 20831178)`) %>%
filter(Datetime_EST < "2021-12-07 17:00:00") %>%
dplyr::select(Temperature, Light, Datetime_EST) -> KB_08112021
KB_120821 <- read_csv("raw_data/KBNursery_2021_12_08.csv", skip = 1)
KB_120821%>%
mutate(Datetime_EST=with_tz(mdy_hm(`Date Time, GMT-05:00`, tz = "Etc/GMT+5"), tzone = "Etc/GMT+5")) %>%
mutate(Datetime_EST=with_tz(Datetime_EST, tzone = "America/New_York")) %>%
dplyr::rename(Temperature = `Temp, °C (LGR S/N: 21236769, SEN S/N: 21236769)`) %>%
dplyr::rename(Light = `Intensity, lum/ft² (LGR S/N: 21236769, SEN S/N: 21236769)`) %>%
filter(Datetime_EST > "2021-12-10 04:00:00" & Datetime_EST < "2021-12-31 00:00:00") %>%
dplyr::select(Temperature, Light, Datetime_EST) -> KB_120821
rbind(KB_05282021, KB_08112021, KB_120821) -> all_KB_data
all_KB_data %>%
mutate(site = "Nursery") -> all_KB_data
all_KB_data$Temperature <- as.numeric(all_KB_data$Temperature)
all_KB_data %>%
tidyr::separate(Datetime_EST, c("Date", "Time"), sep = "\\ ", remove = FALSE) %>%
mutate(Date = as.Date(Date), Time = format(Datetime_EST, format = "%H:%M:%S")) -> all_KB_data
all_KB_data %>%
mutate(Time_period = hms(Time)) -> all_KB_data
all_KB_data %>%
full_join(., CCC_temp_2021_06_01) %>%
filter(Date < "2021-11-05" & Date > "2021-06-01") %>%
mutate(year = year(Date), month = month(Date), day = day(Date)) %>%
as.data.frame() %>%
write_csv(., "tidy_KB_CCC_data.csv")
tidy_KB_CCC_data <- read_csv("results_csv/tidy_KB_CCC_data.csv")
tidy_KB_CCC_data %>%
filter(Date < "2021-11-01" & Date > "2021-06-23") %>%
ggplot(., aes(x=Date, y=Temperature, color = site)) +
geom_line() +
theme_bw() +
scale_color_manual(values = c("CCC" = "orange", "Nursery" = "darkblue")) +
scale_x_date(date_labels = "%b %Y",  # Customize the date format
date_breaks = "1 month") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(x="Month Year", y = "Temperature")
tidy_KB_CCC_data %>%
filter(Date <= "2021-10-30" & Date >= "2021-10-28") %>%
ggplot(., aes(x=Datetime_EST, y=Temperature, color = site)) +
geom_point() +
geom_line() +
theme_bw() +
scale_color_manual(values = c("CCC" = "orange", "Nursery" = "darkblue")) +
labs(x="Date", y = "Temperature")  +
scale_x_datetime(date_breaks = "3 hours", date_labels = "%H:%M") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
tidy_KB_CCC_data %>%
group_by(Date,site) %>%
summarise(mean_daily_temp = mean(Temperature), sd_daily_temp = sd(Temperature), daily_range = (max(Temperature)-min(Temperature))) %>%
ggplot(., aes(x=Date, y=daily_range, color = site)) +
geom_line() +
scale_color_manual(values = c("CCC" = "orange", "Nursery" = "darkblue")) +
theme_bw()
tidy_KB_CCC_data %>%
filter(site == "CCC") %>%
mutate(year = year(Date), month = month(Date), day = day(Date)) %>%
filter(Date < "2021-12-01") %>%
mutate(Date = as.factor(Date)) %>%
ggplot(., aes(x=Time, y=Temperature, color = Date)) +
geom_point() +
geom_smooth(se=F) +
facet_wrap(~month, scales = "free_x") +
scale_x_time(labels = scales::time_format("%H:%M")) +
theme_bw() +
theme(legend.position = "none")
tidy_KB_CCC_data %>%
filter(site == "Nursery") %>%
mutate(year = year(Date), month = month(Date), day = day(Date)) %>%
filter(Date < "2021-12-01") %>%
mutate(Date = as.factor(Date)) %>%
ggplot(., aes(x=Time, y=Temperature, color = Date)) +
geom_point() +
geom_smooth(se=F) +
facet_wrap(~month) +
scale_x_time(labels = scales::time_format("%H:%M")) +
theme_bw() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
tidy_KB_CCC_data %>%
filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-23") %>%
ggplot(., aes(x=Time, y=Temperature, color = site)) +
geom_point() +
geom_smooth() +
facet_wrap(~month) +
scale_x_time(labels = scales::time_format("%H:%M"))+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
tidy_KB_CCC_data %>%
filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-01") %>%
ggplot(., aes(x=Datetime_EST, y=Temperature, color = site)) +
geom_line() +
facet_wrap(~month, scales = "free") +
scale_color_manual(values = c("CCC" = "orange", "Nursery" = "darkblue")) +
theme_bw()  +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
tidy_KB_CCC_data %>%
filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-01") %>%
group_by(as.Date(Datetime_EST), site) %>%
mutate(season = case_when(`as.Date(Datetime_EST)` <= "2021-05-25" ~ "Dry",
`as.Date(Datetime_EST)` >= "2021-05-26" & `as.Date(Datetime_EST)` <= "2021-10-15" ~ "Wet",
`as.Date(Datetime_EST)` >= "2021-10-16" ~ "Dry")) %>%
group_by(site, season) %>%
summarise(sample_size = n(), mean_temp = mean(Temperature), sd_temp = sd(Temperature), max_temp = max(Temperature), min_temp =min(Temperature)) %>%
write_csv("summary_stats_temp_data.csv")
tidy_KB_CCC_data %>%
filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-01") %>%
group_by(as.Date(Datetime_EST), site) %>%
mutate(season = case_when(`as.Date(Datetime_EST)` <= "2021-05-25" ~ "Dry",
`as.Date(Datetime_EST)` >= "2021-05-26" & `as.Date(Datetime_EST)` <= "2021-10-15" ~ "Wet",
`as.Date(Datetime_EST)` >= "2021-10-16" ~ "Dry")) %>%
group_by(site, season) %>%
summarise(sample_size = n(), mean_temp = mean(Temperature), sd_temp = sd(Temperature), max_temp = max(Temperature), min_temp =min(Temperature))
tidy_KB_CCC_data %>%
#filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-01") %>%
group_by(as.Date(Datetime_EST), site) %>%
mutate(season = case_when(`as.Date(Datetime_EST)` <= "2021-05-25" ~ "Dry",
`as.Date(Datetime_EST)` >= "2021-05-26" & `as.Date(Datetime_EST)` <= "2021-10-15" ~ "Wet",
`as.Date(Datetime_EST)` >= "2021-10-16" ~ "Dry")) %>%
group_by(site, season) %>%
summarise(sample_size = n(), mean_temp = mean(Temperature), sd_temp = sd(Temperature), max_temp = max(Temperature), min_temp =min(Temperature))
tidy_KB_CCC_data %>%
filter(as.Date(Datetime_EST) < "2021-12-01") %>%
dplyr::select(Temperature, Datetime_EST, site) %>%
group_by(as.Date(Datetime_EST), site) %>%
summarise(mean_daily_temp = mean(Temperature), sd_daily_temp = sd(Temperature), daily_range = (max(Temperature)-min(Temperature))) %>%
ggplot(., aes(x=`as.Date(Datetime_EST)`, y=daily_range, color = site)) +
geom_line() +
theme_bw() +
scale_color_manual(values = c("CCC" = "orange", "Nursery" = "darkblue")) +
scale_x_date(date_labels = "%b",  # Customize the date format
date_breaks = "1 month") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(x="Month", y = "Daily Variability (ºC/day)")
tidy_KB_CCC_data %>%
#filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-01") %>%
group_by(site) %>%
summarise(sample_size = n(), mean_temp = mean(Temperature), sd_temp = sd(Temperature), max_temp = max(Temperature), min_temp =min(Temperature)) %>%
write_csv("summary_stats_temp_data.csv")
tidy_KB_CCC_data %>%
#filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-01") %>%
group_by(site) %>%
summarise(sample_size = n(), mean_temp = mean(Temperature), sd_temp = sd(Temperature), max_temp = max(Temperature), min_temp =min(Temperature))
tidy_KB_CCC_data %>%
dplyr::select(Temperature, Datetime_EST, site) %>%
group_by(as.Date(Datetime_EST), site) %>%
mutate(mean_daily_temp = mean(Temperature), sd_daily_temp = sd(Temperature), daily_range = (max(Temperature)-min(Temperature))) %>%
group_by(site, season) %>%
summarise(average_daily_range = mean(daily_range), max_daily_range = max(daily_range))
tidy_KB_CCC_data %>%
dplyr::select(Temperature, Datetime_EST, site) %>%
group_by(as.Date(Datetime_EST), site) %>%
mutate(mean_daily_temp = mean(Temperature), sd_daily_temp = sd(Temperature), daily_range = (max(Temperature)-min(Temperature))) %>%
group_by(site) %>%
summarise(average_daily_range = mean(daily_range), max_daily_range = max(daily_range))
