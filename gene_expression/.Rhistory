term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term,
vSize = 1  # Or use Count if you want weighted sizes
)
treemapPlot(bp_treemap_df)
bp_treemap_df
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term,
vSize = Count  # Or use Count if you want weighted sizes
)
treemapPlot(bp_treemap_df)
bp_treemap_df$termName <- Term(bp_treemap_df$term)
bp_treemap_df
treemap(bp_treemap_df)
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term,
vSize = Count  # Or use Count if you want weighted sizes
)
bp_treemap_df
bp_df
all_slim_results
# Example for BP ontology
bp_df <- all_slim_results %>%
filter(Ontology == "BP") %>%
mutate(Count = as.numeric(Count))
bp_df
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term,
vSize = Count  # Or use Count if you want weighted sizes
)
bp_treemap_df$termName <- GO.db::Term(bp_treemap_df$term) #gets child GO term names again
bp_treemap_df$termName <- =Term(bp_treemap_df$term) #gets child GO term names again
bp_treemap_df$termName <- Term(bp_treemap_df$term) #gets child GO term names again
bp_treemap_df
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vSize = "Significant",                      #Size of boxes based on the "Significant Annotated" count
vColor = "module",                     #Color boxes by VAR
type = "categorical",
font.size.title = 16,
font.size.labels = 12)
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vColor = "module",                     #Color boxes by VAR
type = "categorical",
font.size.title = 16,
font.size.labels = 12)
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vColor = "module",
font.size.title = 16,
font.size.labels = 12)
bp_treemap_df
all_slim_results
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term,
vSize = Percent
)
bp_treemap_df$termName <- Term(bp_treemap_df$term) #gets child GO term names again
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vColor = "module",
font.size.title = 16,
font.size.labels = 12)
bp_treemap_df
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term
)
bp_treemap_df$termName <- Term(bp_treemap_df$term) #gets child GO term names again
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vColor = "module",
font.size.title = 16,
font.size.labels = 12)
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vColor = "module",
vSize = 1,
font.size.title = 16,
font.size.labels = 12)
bp_treemap_df
View(BP_Res)
View(bp_treemap_df)
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
# If GOTerms is NA or empty, use the GO Slim term itself
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", GO, GOTerms)) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term
)
bp_treemap_df$termName <- Term(bp_treemap_df$term) #gets child GO term names again
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vColor = "module",
vSize = 1,
font.size.title = 16,
font.size.labels = 12)
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
# If GOTerms is NA or empty, use the GO Slim term itself
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", GO, GOTerms)) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term,
vSize = 1
)
treemapPlot(bp_treemap_df,
title = "GO Enrichment Treemap - Biological Process",
vColor = "module",
vSize = 1,
font.size.title = 16,
font.size.labels = 12)
treemapPlot(bp_treemap_df %>% select(term = termLabel, parentTerm, vSize, module),
fill = "module")
treemapPlot(bp_treemap_df) %>% select(term = termLabel, parentTerm, vSize, module),
treemapPlot(bp_treemap_df)
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
# If GOTerms is NA or empty, use the GO Slim term itself
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", GO, GOTerms)) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term
)
treemapPlot(bp_treemap_df)
bp_treemap_df
treemapPlot(bp_treemap_df)
# Expand GOTerms into one row per child GO term
bp_treemap_df <- bp_df %>%
# If GOTerms is NA or empty, use the GO Slim term itself
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", GO, GOTerms)) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(
id = GOTerms,
term = GOTerms,  # Optionally, map to full term names using Term() from GO.db
parentTerm = Term,
size = Count
)
bp_treemap_df$termName <- Term(bp_treemap_df$term) #gets child GO term names again
treemapPlot(bp_treemap_df)
# importing data generated from DESeq2 script
lnames=load("RData_files/data4wgcna.RData")
View(vsd.wg)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
library(topGO)
library(plyr)
library(tidyr)
library(scales)
library(stringr)
library(GSEABase)
library(rrvgo)
load("Rdata_files/initial_fullddsdesigncountsVsdcounts.RData")
load("Rdata_files/realModels_Acer.RData")
load("Rdata_files/vsd.RData")
load("Rdata_files/pvals.RData")
geneID2GO <- read.delim("~/OneDrive - University of Miami/PhD/NOAA AOML Coral Program/chapter2_UrbanCorals/Acropora_iso2go.tab", header = FALSE, stringsAsFactors = FALSE)
colnames(geneID2GO) <- c("gene", "GO")
length(geneID2GO) #7995
# Split on semicolon
geneID2GO <- setNames(strsplit(geneID2GO$GO, ";"), geneID2GO$gene)
# Background = all genes from the mapping
allgenes <- names(geneID2GO)
GO_results <- read_csv("4_WGCNA/GO_enrichment_all_modules_allterms.csv")
GO_slim <- read_csv("4_WGCNA/GOslim_enrichment_all_modules.csv")
GO_results <- read_csv("4_WGCNA/GO_enrichment_all_modules_allterms.csv")
GO_slim <- read_csv("4_WGCNA/GOslim_enrichment_all_modules.csv")
# Merge GO_results with GO_slim to add GOTerms column
merged_results <- GO_results %>%
left_join(GO_slim %>% select(GO, GOTerms), by = c("GO.ID" = "GO"))
# Merge GO_results with GO_slim to add GOTerms column
merged_results <- GO_results %>%
left_join(GO_slim %>% dplyr::select(GO, GOTerms), by = c("GO.ID" = "GO"))
merged_results
GO_results
GO_slim
GO_slim %>%
separate(GOTerms, into = paste0("GOTerm", 1:20), sep = ", ", fill = "right")
GO_slim
GO_slim %>%
rename(ParentTerm = GO)
GO_slim %>%
dplyr::rename(ParentTerm = GO)
GO_slim %>%
dplyr::rename(ParentTerm = GO) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
dplyr::rename(ChildTerm = GOTerms)
GO_slim %>%
dplyr::rename(ParentTerm = GO) %>%
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", GO, GOTerms)) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
dplyr::rename(ChildTerm = GOTerms)
GO_slim %>%
dplyr::rename(ParentTerm = GO) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", GO, GOTerms)) %>%
dplyr::rename(ChildTerm = GOTerms)
GO_slim
GO_slim %>%
dplyr::rename(ParentTerm = GO) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", ParentTerm, GOTerms)) %>%
dplyr::rename(ChildTerm = GOTerms)
GO_slim %>%
dplyr::rename(ParentTerm = GO) %>%
separate_rows(GOTerms, sep = ",\\s*") %>%
mutate(GOTerms = ifelse(is.na(GOTerms) | GOTerms == "", ParentTerm, GOTerms)) %>%
dplyr::rename(ChildTerm = GOTerms) -> GO_slim_edited
GO_slim_edited
GO_results
GO_slim
GO_slim_edited
# Merge GO_results with GO_slim to add GOTerms column
merged_results <- GO_results %>%
full_join(GO_slim_edited %>% dplyr::select(ParentTerm, ChildTerm), by = c("GO.ID" = "ChildTerm"))
merged_results
View(merged_results)
merged_results %>%
dpylr::rename(GO_slim_term = ParentTerm)
merged_results %>%
dplyr::rename(GO_slim_term = ParentTerm)
GO_slim_edited
GO_slim_edited %>%
full_join(GO_results, by = c("GO.ID" = "ChildTerm"))
# Merge GO_results with GO_slim to add GOTerms column
GO_slim_edited %>%
full_join(GO_results, by = c("module", "Ontology" = "Class", "ChildTerm" = "GO.ID"))
GO_slim_edited
GO_results
GO_slim_edited
GO_results
# Merge GO_results with GO_slim to add GOTerms column
GO_slim_edited %>%
full_join(GO_results, by = c("module", "ChildTerm" = "GO.ID"))
# Merge GO_results with GO_slim to add GOTerms column
GO_slim_edited %>%
full_join(GO_results, by = c("module", "ChildTerm" = "GO.ID")) %>%
dplyr::rename(GO_slim_term = ParentTerm, GO_slim_term_description = Term.x, GO_child_term_description = Term.y)
# Merge GO_results with GO_slim to add GOTerms column
GO_slim_edited %>%
full_join(GO_results, by = c("module", "ChildTerm" = "GO.ID")) %>%
dplyr::rename(GO_slim_term = ParentTerm, GO_slim_term_description = Term.x, GO_child_term_description = Term.y) -> merged_results
write_csv(merged_results, "4_WGCNA/GO_enrichment_all_modules_allterms_withGOslim.csv")
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
library(topGO)
library(plyr)
library(tidyr)
library(scales)
library(stringr)
library(GSEABase)
library(rrvgo)
load("Rdata_files/initial_fullddsdesigncountsVsdcounts.RData")
load("Rdata_files/realModels_Acer.RData")
load("Rdata_files/vsd.RData")
load("Rdata_files/pvals.RData")
geneID2GO <- read.delim("~/OneDrive - University of Miami/PhD/NOAA AOML Coral Program/chapter2_UrbanCorals/Acropora_iso2go.tab", header = FALSE, stringsAsFactors = FALSE)
colnames(geneID2GO) <- c("gene", "GO")
length(geneID2GO) #7995
# Split on semicolon
geneID2GO <- setNames(strsplit(geneID2GO$GO, ";"), geneID2GO$gene)
# Background = all genes from the mapping
allgenes <- names(geneID2GO)
GO_results <- read_csv("4_WGCNA/GO_enrichment_all_modules_allterms.csv")
GO_slim <- read_csv("4_WGCNA/GOslim_enrichment_all_modules.csv")
library(DESeq2)
library(arrayQualityMetrics)
library(tidyverse)
counts = read.delim("results/counts.txt")
#select only Acropora genes, remove Symbiodinium
Acer_counts <- counts %>% filter(!grepl("^Symbiodinium[0-9]+$", X))
Sym_counts <- counts %>% filter(!grepl("^Acropora_[0-9]+$", X))
column_to_rownames(Acer_counts, var ="X") -> Acer_counts
Acer_counts %>%
rename_with(~sub("^X(.+)_trimmed$", "Acer_\\1", .)) %>%
select(!X.1) -> Acer_counts
Sym_counts
column_to_rownames(Sym_counts, var ="X") -> Sym_counts
View(Sym_counts)
Acer_counts %>%
rename_with(~sub("^X(.+)_trimmed$", "Acer_\\1", .)) %>%
select(!X.1) -> Acer_counts
View(Acer_counts)
Sym_counts %>%
rename_with(~sub("^X(.+)_trimmed$", "Acer_\\1", .)) %>%
select(!X.1) -> Sym_counts
nrow(Acer_counts) #24,453
ncol(Acer_counts) #20 samples
nrow(Sym_counts) #24,453
ncol(Sym_counts) #20 samples
Acer_counts %>%
select(!c("Acer_1087", "Acer_1088", "Acer_1096", "Acer_2264", "Acer_2383")) -> Acer_counts
Sym_counts %>%
select(!c("Acer_1087", "Acer_1088", "Acer_1096", "Acer_2264", "Acer_2383")) -> Sym_counts
nrow(Sym_counts) #24,453
ncol(Sym_counts)
keep_sym <- rowSums(Sym_counts) >= 10 # you don't want to do too much pre-filtering because DESeq2 needs low-count genes for dispersion estimates
countData_sym <- Sym_counts[keep_sym,]
nrow(countData_sym) #21814
ncol(countData_sym) #15
# importing a design .csv file
design = readxl::read_xlsx("sample_metadata.xlsx")
design %>%
filter(!Sample_ID %in% c("1087", "1088", "1096", "2264", "2383")) -> design
design %>%
mutate(Sample_ID = paste("Acer_", Sample_ID, sep = "")) -> design
column_to_rownames(design, var="Sample_ID") -> design
design$Genotype <- as.factor(design$Genotype)
design$Genotype <- factor(gsub("-", "_", design$Genotype)) #DESeq2 does not like hyphens in factor names
design$Genotype <- factor(gsub("'", "", design$Genotype)) #DESeq2 does not like hyphens in factor names
design$Genotype <- factor(gsub(" ", "", design$Genotype)) #DESeq2 does not like hyphens in factor names
design$Location <- as.factor(design$Location)
str(design) #default is alphabetical order, so CCC is the "baseline"
design$Location <- factor(design$Location, levels = c("nursery","CCC")) #make the contrast so nursery is the baseline
str(design)
colnames(countData)
colnames(countData_sym)
rownames(design)
dds_sym = DESeqDataSetFromMatrix(countData=countData_sym, colData=design, design=~ Genotype + Location)
Vsd_sym=varianceStabilizingTransformation(dds_sym)
dds_sym=DESeq(dds_sym, parallel=TRUE)
dds_sym
res(dds_sym)
results(dds_sym)
summary(results(dds_sym))
Location_CCC_vs_nursery_sym = results(dds_sym,contrast=c("Location","CCC","nursery"))
summary(Location_CCC_vs_nursery_sym, alpha = 0.05)
library(DESeq2)
library(arrayQualityMetrics)
library(tidyverse)
counts = read.delim("results/counts.txt")
#select only Acropora genes, remove Symbiodinium
Sym_counts <- counts %>% filter(!grepl("^Acropora_[0-9]+$", X))
column_to_rownames(Sym_counts, var ="X") -> Sym_counts
Sym_counts %>%
rename_with(~sub("^X(.+)_trimmed$", "Acer_\\1", .)) %>%
select(!X.1) -> Sym_counts
Sym_counts %>%
select(!c("Acer_1087", "Acer_1088", "Acer_1096", "Acer_2264", "Acer_2383")) -> Sym_counts
keep_sym <- rowSums(Sym_counts) >= 10 # you don't want to do too much pre-filtering because DESeq2 needs low-count genes for dispersion estimates
countData_sym <- Sym_counts[keep_sym,]
design = readxl::read_xlsx("sample_metadata.xlsx")
design %>%
filter(!Sample_ID %in% c("1087", "1088", "1096", "2264", "2383")) -> design
design %>%
mutate(Sample_ID = paste("Acer_", Sample_ID, sep = "")) -> design
column_to_rownames(design, var="Sample_ID") -> design
design$Genotype <- as.factor(design$Genotype)
design$Genotype <- factor(gsub("-", "_", design$Genotype)) #DESeq2 does not like hyphens in factor names
design$Genotype <- factor(gsub("'", "", design$Genotype)) #DESeq2 does not like hyphens in factor names
design$Genotype <- factor(gsub(" ", "", design$Genotype)) #DESeq2 does not like hyphens in factor names
design$Location <- as.factor(design$Location)
design$Location <- factor(design$Location, levels = c("nursery","CCC")) #make the contrast so nursery is the baseline
dds_sym = DESeqDataSetFromMatrix(countData=countData_sym, colData=design, design=~ Genotype + Location)
# for large datasets, rlog may take too much time, especially for an unfiltered dataframe
# vsd is much faster and still works for outlier detection
Vsd_sym=varianceStabilizingTransformation(dds_sym)
colnames(Vsd)
colnames(Vsd_sym)
library(Biobase)
e=ExpressionSet(assay(Vsd_sym), AnnotatedDataFrame(as.data.frame(colData(Vsd_sym))))
e=ExpressionSet(assay(Vsd_sym), AnnotatedDataFrame(as.data.frame(colData(Vsd_sym))))
# running outlier detection
arrayQualityMetrics(e,intgroup=c("Location", "Genotype"),force=T)
# if there were outliers:
outs=c(6,8) #these numbers were taken from the index.html report from arrayQualityMetrics Figure 2 "Outlier detection"
countData=countData_sym[,-outs]
#counts4wgcna=counts4wgcna[,-outs]
Vsd=Vsd_sym[,-outs]
design=design[-outs,]
# remaking model with outliers removed from dataset
dds = DESeqDataSetFromMatrix(countData=countData, colData=design, design=~ Genotype + Location)
# generating normalized variance-stabilized data for PCoA, heatmaps, etc
vsd=assay(Vsd)
colnames(vsd)
# takes the sample IDs and factor levels from the design to create new column names for the dataframe
snames=paste(colnames(countData),design[,2], design[,3],sep="_")
# renames the column names
colnames(vsd)=snames
library(BiocParallel)
dds=DESeq(dds, parallel=TRUE)
SF.data <- estimateSizeFactors(dds)
print(sizeFactors(SF.data)) # everything is less than 4, so I can use vst
read.table(file = "1_bioinformatics/Symbiodinium_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
dplyr::rename(gene = V1,
annot = V2) -> iso2geneName
resultsNames(dds)
results(dds, alpha = 0.05) # location CCC vs. nursery
summary(results(dds, alpha = 0.05))
# Location_CCC_vs_Nursery (we want "nursery" to be the baseline or control, and CCC to be the comparative variable or "treatment" group)
Location_CCC_vs_nursery= results(dds,contrast=c("Location","CCC","nursery"))
summary(Location_CCC_vs_nursery, alpha = 0.05)
dds
# Location_CCC_vs_Nursery (we want "nursery" to be the baseline or control, and CCC to be the comparative variable or "treatment" group)
Location_CCC_vs_nursery= results(dds,contrast=c("Location","CCC","nursery"))
summary(Location_CCC_vs_nursery, alpha = 0.05)
dev.off()
plotMA(Location_CCC_vs_nursery, ylim=c(-20,20))
resLFC <- lfcShrink(dds, coef="Location_CCC_vs_nursery", type="apeglm")
summary(resLFC, alpha = 0.05)
plotMA(resLFC, ylim=c(-20,20))
#create data frames for DGEs
degs_Location_CCC_vs_nursery_lfcshrink=row.names(resLFC)[resLFC$padj<0.05 & !(is.na(resLFC$padj))]
length(degs_Location_CCC_vs_nursery_lfcshrink) #819
degs_Location_CCC_vs_nursery=row.names(Location_CCC_vs_nursery)[Location_CCC_vs_nursery$padj<0.05 & !(is.na(Location_CCC_vs_nursery$padj))]
length(degs_Location_CCC_vs_nursery) #819
degs_Location_CCC_vs_nursery=row.names(Location_CCC_vs_nursery)[Location_CCC_vs_nursery$padj<0.05 & !(is.na(Location_CCC_vs_nursery$padj))]
Location_CCC_vs_nursery %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05) %>%
full_join(., iso2geneName, by = "gene") %>%
drop_na(baseMean) %>%
select(gene, annot, baseMean:padj) %>%
write_csv("Location_CCC_vs_nursery_annotDGEs_symbiodinium_padj05.csv")
resLFC %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05) %>%
full_join(., iso2geneName, by = "gene") %>%
drop_na(baseMean) %>%
select(gene, annot, baseMean:padj) %>%
write_csv("resLFCLocation_CCC_vs_nursery_annotDGEs_Symbiodinium_padj05.csv")
# similarity among samples
pheatmap(cor(vsd))
# heatmap and hierarchical clustering:
#load("Rdata_files/vsd.RData")
library(pheatmap)
# similarity among samples
pheatmap(cor(vsd))
library(vegan)
# library(rgl)
library(ape)
conditions=design
colnames(vsd)
rownames(conditions)
conditions=design
colnames(vsd)
rownames(conditions)
# creating a PCoA eigenvalue matrix
dds.pcoa=pcoa(dist(t(vsd),method="manhattan")/1000)
scores=dds.pcoa$vectors
# copy this table for % variation explained by each axis (Relative_eig column)
dds.pcoa$values
plot(dds.pcoa$values$Relative_eig)
points(dds.pcoa$values$Broken_stick,col="red",pch=3)
par(mfrow=c(1,2))
plot(scores[,1], scores[,2],col=c("orange","darkblue")[as.numeric(as.factor(conditions$Location))],pch=c(15,17,25)[as.numeric((as.factor(conditions$Genotype)))], xlab="Coordinate 1", ylab="Coordinate 2", main="Location")
ordispider(scores, conditions$Location, label=F, col=c("orange","darkblue"))
legend("topright", legend=c("CCC", "Nursery"), fill = c("orange","darkblue"), bty="n")
legend("topleft", legend=c("Cheetos_B", "MiamiBeach_C", "SunnyIsles_E"), pch=c(15,17,25), bty="n")
plot(scores[,1], scores[,2],col=c("orange","lightblue", "pink")[as.numeric(as.factor(conditions$Genotype))],pch=c(15,17,25)[as.numeric((as.factor(conditions$Location)))], xlab="Coordinate 1", ylab="Coordinate 2", main="Genotype")
ordispider(scores, conditions$Genotype, label=F, col=c("orange","lightblue", "pink"))
legend("topleft", legend=c("Cheetos_B", "MiamiBeach_C", "SunnyIsles_E"), fill = c("orange","lightblue", "pink"), bty="n")
legend("topright", legend=c("CCC", "Nursery"), pch=c(15,17,25), bty="n")
dev.off()
dev.off()
plot(scores[,1], scores[,2],col=c("orange","darkblue")[as.numeric(as.factor(conditions$Location))],pch=c(15,17,25)[as.numeric((as.factor(conditions$Genotype)))], xlab="Coordinate 1", ylab="Coordinate 2", main="Location")
ordispider(scores, conditions$Location, label=F, col=c("orange","darkblue"))
legend("topright", legend=c("CCC", "Nursery"), fill = c("orange","darkblue"), bty="n")
legend("topleft", legend=c("Cheetos_B", "MiamiBeach_C", "SunnyIsles_E"), pch=c(15,17,25), bty="n")
plot(scores[,1], scores[,2],col=c("orange","lightblue", "pink")[as.numeric(as.factor(conditions$Genotype))],pch=c(15,17,25)[as.numeric((as.factor(conditions$Location)))], xlab="Coordinate 1", ylab="Coordinate 2", main="Genotype")
ordispider(scores, conditions$Genotype, label=F, col=c("orange","lightblue", "pink"))
legend("topleft", legend=c("Cheetos_B", "MiamiBeach_C", "SunnyIsles_E"), fill = c("orange","lightblue", "pink"), bty="n")
legend("topright", legend=c("CCC", "Nursery"), pch=c(15,17,25), bty="n")
plot(scores[,1], scores[,2],col=c("orange","darkblue")[as.numeric(as.factor(conditions$Location))], xlab="Coordinate 1", ylab="Coordinate 2", main="Location")
ordispider(scores, conditions$Location, label=F, col=c("orange","darkblue"))
legend("topright", legend=c("CCC", "Nursery"), fill = c("orange","darkblue"), bty="n")
# formal analysis of variance in distance matricies:
ad=adonis2(t(vsd)~Genotype + Location,data=design,method="manhattan",permutations=1e6)
summary(ad)
ad
