filtered_KB_data_20202021 %>%
mutate(site = case_when(site == "Nursery" ~ "Nursery_SST_19812012")) %>%
separate(Datetime_EST, into = c("Date", "Time"), sep = " ") %>%
arrange(Date) %>%
dplyr::group_by(Date) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
dplyr::select(!c(Temperature, Time, Month, Year)) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery_SST_19812012" ~ (mean_daily_temp - 29.53))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) -> Long.data.DHW.nurserySST
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021)
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
ggplot(., aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed", color = "red")+
geom_hline(yintercept=4, linetype="dashed", color = "orange")+
geom_line(aes(y = DHW_insitu)) #the tiniest blip
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021)
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST)
Long.data.DHW.nurserySST$DHW<-rollapplyr(Long.data.DHW.nurserySST$Weeks_Stress,list(-(83:0)),sum,fill=NA)
Long.data.DHW.CCCSST$DHW<-rollapplyr(Long.data.DHW.CCCSST$Weeks_Stress,list(-(83:0)),sum,fill=NA)
# Plot just DHW SST data
full_join(Long.data.DHW.nurserySST, Long.data.DHW.CCCSST) %>%
filter(ymd(Date) >= "2021-01-01") %>%
ggplot(., aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW_SST, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
xlab("Date") +
theme_classic() +
scale_color_manual(values = c("CURES_tilt" = "orange", "Nursery" = "darkblue"))
# Plot just DHW SST data
full_join(Long.data.DHW.nurserySST, Long.data.DHW.CCCSST) %>%
filter(ymd(Date) >= "2021-01-01") %>%
ggplot(., aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
xlab("Date") +
theme_classic() +
scale_color_manual(values = c("CURES_tilt" = "orange", "Nursery" = "darkblue"))
# Plot just DHW SST data
full_join(Long.data.DHW.nurserySST, Long.data.DHW.CCCSST) %>%
filter(ymd(Date) >= "2021-01-01") %>%
ggplot(., aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
xlab("Date") +
theme_classic() +
scale_color_manual(values = c("CCC_SST_19812012" = "orange", "Nursery_SST_19812012" = "darkblue"))
Long.data.DHW.nurserySST_2021$DHW<-rollapplyr(Long.data.DHW.nurserySST_2021$Weeks_Stress,list(-(83:0)),sum,fill=NA)
ggplot(Long.data.DHW.nurserySST_2021, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW)) #ok this looks better
Long.data.DHW.CCCSST_2021$DHW<-rollapplyr(Long.data.DHW.CCCSST_2021$Weeks_Stress,list(-(83:0)),sum,fill=NA)
max(Long.data.DHW.CCCSST_2021$DHW, na.rm = TRUE)
Long.data.DHW.nurseryinsitu$DHW<-rollapplyr(Long.data.DHW.nurseryinsitu$Weeks_Stress,list(-(83:0)),sum,fill=NA)
max(Long.data.DHW.nurseryinsitu$DHW,  na.rm = TRUE) #0
Long.data.DHW.CCCinsitu$DHW<-rollapplyr(Long.data.DHW.CCCinsitu$Weeks_Stress,list(-(83:0)),sum,fill=NA)
ggplot(Long.data.DHW.CCCinsitu, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW)) #the tiniest blip
Long.data.DHW.CCCinsitu$DHW<-rollapplyr(Long.data.DHW.CCCinsitu$Weeks_Stress,list(-(83:0)),sum,fill=NA)
max(Long.data.DHW.CCCinsitu$DHW, na.rm = TRUE)
# now do CCC
curestilt_20202021 %>%
mutate(site = case_when(site == "CURES_tilt" ~ "CCC_insitu")) %>%
separate(Datetime_EST, into = c("Date", "Time"), sep = " ") %>%
arrange(Date) %>%
dplyr::group_by(Date) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
dplyr::select(!c(Temperature, Time)) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "CURES_tilt" ~ (mean_daily_temp - MMM_CCC_tilt))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7)  -> Long.data.DHW.CCCinsitu
Long.data.DHW.CCCinsitu$DHW<-rollapplyr(Long.data.DHW.CCCinsitu$Weeks_Stress,list(-(83:0)),sum,fill=NA)
ggplot(Long.data.DHW.CCCinsitu, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW)) #the tiniest blip
Long.data.DHW.CCCinsitu
# now do CCC
curestilt_20202021 %>%
mutate(site = case_when(site == "CURES_tilt" ~ "CCC_insitu")) %>%
separate(Datetime_EST, into = c("Date", "Time"), sep = " ") %>%
arrange(Date) %>%
dplyr::group_by(Date) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
dplyr::select(!c(Temperature, Time)) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "CCC_insitu" ~ (mean_daily_temp - MMM_CCC_tilt))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7)  -> Long.data.DHW.CCCinsitu
Long.data.DHW.CCCinsitu$DHW<-rollapplyr(Long.data.DHW.CCCinsitu$Weeks_Stress,list(-(83:0)),sum,fill=NA)
ggplot(Long.data.DHW.CCCinsitu, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW)) #the tiniest blip
max(Long.data.DHW.CCCinsitu$DHW, na.rm = TRUE)
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
ggplot(., aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed", color = "red")+
geom_hline(yintercept=4, linetype="dashed", color = "orange")+
geom_line(aes(y = DHW)) #the tiniest blip
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST)
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021)
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
ggplot(., aes(x=ymd(Date), y=DHW)) +
geom_hline(yintercept=8, linetype="dashed", color = "red")+
geom_hline(yintercept=4, linetype="dashed", color = "orange")
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
ggplot(., aes(x=ymd(Date), y=DHW)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed", color = "red")+
geom_hline(yintercept=4, linetype="dashed", color = "orange")
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed", color = "red")+
geom_hline(yintercept=4, linetype="dashed", color = "orange")
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed", color = "red")+
geom_hline(yintercept=4, linetype="dashed", color = "orange") +
theme_bw()
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed") +
theme_bw()
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("Nursery_SST_20202021", "CCC_insitu", "CCC_SST_20202021", "Nursery_SST_19812012", "CCC_SST_19812012"))) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed") +
theme_bw()
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
# mutate(site = factor(site, levels = c("Nursery_SST_20202021", "CCC_insitu", "CCC_SST_20202021", "Nursery_SST_19812012", "CCC_SST_19812012"))) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed") +
theme_bw()
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("Nursery_insitu", "Nursery_SST_20202021", "CCC_insitu", "CCC_SST_20202021", "Nursery_SST_19812012", "CCC_SST_19812012"))) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed") +
theme_bw()
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu"))) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed") +
theme_bw()
ggsave("all_DHWs.png", width = 10, height = 7)
all_temp_data
all_temp_data %>%
mutate(Season = case_when(as.Date(Datetime_EST) <= "2021-10-15" ~ "Wet",
as.Date(Datetime_EST) >= "2021-10-16" ~ "Dry")) %>%
dplyr::group_by(site, Season) %>%
dplyr::summarise(mean_temp = mean(Temperature), sd_temp = sd(Temperature), min_temp = min(Temperature), max_temp = max(Temperature), count = n()) %>%
ggplot(., aes(x=Season,y=mean_temp,color=site)) +
geom_point(position = position_dodge(width = 0.3)) +
geom_errorbar(aes(ymin=mean_temp-sd_temp, ymax=mean_temp+sd_temp, fill=site), width = 0.2,position = position_dodge(width = 0.3)) +
theme_classic() +
scale_color_manual(values = c("CURES_tilt" = "orange", "Nursery" = "darkblue"))
all_temp_data %>%
mutate(Season = case_when(as.Date(Datetime_EST) <= "2021-10-15" ~ "Wet",
as.Date(Datetime_EST) >= "2021-10-16" ~ "Dry")) -> alldata_2021
all_temp_data
all_temp_data
View(all_temp_data)
CRW_SST_2020_2021 %>%
mutate(site = case_when(site == "Nursery" ~ "20202021_SST_Nursery",
site == "CCC" ~ "20202021_SST_CCC")) -> CRW_SST_2020_2021
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year)) %>%
filter(Date < "2021-12-01" & Date > "2021-06-20")
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year)) %>%
filter(Date < "2021-12-01" & Date > "2021-06-20") %>%
mutate(Season = case_when(Date <= "2021-10-15" ~ "Wet",
Date >= "2021-10-16" ~ "Dry")) -> alldata_2021
alldata_2021
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year))
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year))
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year, Temperature)) %>%
distinct()
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year, Temperature)) %>%
distinct() %>%
filter(Date < "2021-12-01" & Date > "2021-06-20") %>%
mutate(Season = case_when(Date <= "2021-10-15" ~ "Wet",
Date >= "2021-10-16" ~ "Dry")) -> alldata_2021
alldata_2021
CRW_SST_2020_2021
MM.CRW_SST_2020_2021
CRW_SST_2020_2021 <- read_csv("CRW_SST_2020_2021.csv")
full_join(CRW_SST_2020_2021, CCC_SST_2020.data) %>%
select(!Dates_2020) %>%
arrange(Date) -> CRW_SST_2020_2021
CRW_SST_2020_2021
CRW_SST_2020_2021 %>%
mutate(site = case_when(site == "Nursery" ~ "20202021_SST_Nursery",
site == "CCC" ~ "20202021_SST_CCC")) -> CRW_SST_2020_2021
CRW_SST_2020_2021
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year, Temperature)) %>%
distinct() %>%
filter(Date < "2021-12-01" & Date > "2021-06-20") %>%
mutate(Season = case_when(Date <= "2021-10-15" ~ "Wet",
Date >= "2021-10-16" ~ "Dry")) -> alldata_2021
alldata_2021
temp.summary<- summaryBy(Temperature ~ site + Season, data = alldata_2021,
FUN = function(x) { c(max = max(x), min = min(x)) } )
alldata_2021
temp.summary<- summaryBy(mean_daily_temp ~ site + Season, data = alldata_2021,
FUN = function(x) { c(max = max(x), min = min(x)) } )
temp.summary$Temp.seasonal <- temp.summary$Temperature.max - temp.summary$Temperature.min
temp.summary
- temp.summary$mean_daily_temp.min
temp.summary$Temp.seasonal <- temp.summary$mean_daily_temp.max - temp.summary$mean_daily_temp.min
temp.summary %>%
filter(mean_daily_temp.max > 30.5) %>%
group_by(site, Season) %>%
dplyr::summarise(d.above.30.5 = n()) -> temp.d.30.5
temp.d.30.5
temp.summary
Daily.range <- summaryBy(mean_daily_temp ~ Date + site + Season, data=alldata_2021, FUN=c(max,min,mean,sd))
Daily.range$temp.daily.range <- Daily.range$mean_daily_temp.max - Daily.range$mean_daily_temp.min
Daily.range
temp.summary<- summaryBy(mean_daily_temp ~ site + Season, data = alldata_2021,
FUN = function(x) { c(max = max(x), min = min(x)) } )
temp.summary
temp.summary$Temp.seasonal <- temp.summary$mean_daily_temp.max - temp.summary$mean_daily_temp.min
temp.summary
MaxDHW
View(MaxDHW_SST)
cbind(temp.summary, MaxDHW_SST)
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu")))
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu"))) %>%
group_by(site, Year) %>%
summarise(maxDHW = max(DHW), na.rm = TRUE)
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu"))) %>%
group_by(site, Year) %>%
summarise(maxDHW = max(DHW, na.rm = TRUE))
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu"))) %>%
filter(Year == "2021") %>%
group_by(site) %>%
summarise(maxDHW = max(DHW, na.rm = TRUE))
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu")))
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu"))) %>%
group_by(site) %>%
summarise(maxDHW = max(DHW, na.rm = TRUE))
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu"))) %>%
group_by(site) %>%
summarise(maxDHW = max(DHW, na.rm = TRUE)) -> max_DHW_alltypes
cbind(temp.summary, max_DHW_alltypes)
max_DHW_alltypes
temp.summary, max_DHW_alltypes
temp.summary
max_DHW_alltypes
temp.summary
temp.summary<- summaryBy(mean_daily_temp ~ site, data = alldata_2021,
FUN = function(x) { c(max = max(x), min = min(x)) } )
temp.summary$Temp.seasonal <- temp.summary$mean_daily_temp.max - temp.summary$mean_daily_temp.min
cbind(temp.summary, max_DHW_alltypes)
temp.summary
max_DHW_alltypes
temp.summary
max_DHW_alltypes
#bind all DHWs
max_DHW_alltypes %>%
filter(site != "CCC_SST_19812012" & site != "Nursery_SST_19812012") %>%
cbind(temp.summary, max_DHW_alltypes) %>%
dplyr::select(!c(`year(Date)`,site)) -> temp_DHW_summary
#bind all DHWs
max_DHW_alltypes %>%
filter(site != "CCC_SST_19812012" & site != "Nursery_SST_19812012") %>%
cbind(temp.summary, .) %>%
dplyr::select(!c(`year(Date)`,site)) -> temp_DHW_summary
max_DHW_alltypes %>%
filter(site != "CCC_SST_19812012" & site != "Nursery_SST_19812012") %>%
cbind(temp.summary, .)
#bind all DHWs
max_DHW_alltypes %>%
filter(site != "CCC_SST_19812012" & site != "Nursery_SST_19812012") %>%
cbind(temp.summary, .)  -> temp_DHW_summary
write_csv(temp_DHW_summary, "temp_DHW_summary.csv")
temp_DHW_summary
scale_by_max <- function(x) {
x * 100 / max(x, na.rm = TRUE)
}
colnames(temp_DHW_summary) <- c("site", "Max", "Min", "Seasonal", "DHW")
temp_DHW_summary %>%
dplyr::mutate(across(everything(), as.numeric)) %>%
dplyr::mutate(across(everything(), scale_by_max)) -> temp_summary_percent
temp_DHW_summary
temp_DHW_summary %>%
column_to_rownames(var="site") -> temp_DHW_summary
temp_DHW_summary %>%
dplyr::mutate(across(everything(), as.numeric)) %>%
dplyr::mutate(across(everything(), scale_by_max)) -> temp_summary_percent
temp_DHW_summary
#bind all DHWs
max_DHW_alltypes %>%
filter(site != "CCC_SST_19812012" & site != "Nursery_SST_19812012") %>%
cbind(temp.summary, .)  -> temp_DHW_summary
colnames(temp_DHW_summary) <- c("site", "Max", "Min", "Seasonal", "DHW")
temp_DHW_summary
max_DHW_alltypes
#bind all DHWs
max_DHW_alltypes %>%
filter(site != "CCC_SST_19812012" & site != "Nursery_SST_19812012") %>%
cbind(temp.summary, .)  -> temp_DHW_summary
temp_DHW_summary
temp_DHW_summary %>%
column_to_rownames(var="site") -> temp_DHW_summary
temp_DHW_summary
colnames(temp_DHW_summary) <- c("Max", "Min", "Seasonal", "DHW")
temp_DHW_summary %>%
dplyr::mutate(across(everything(), as.numeric)) %>%
dplyr::mutate(across(everything(), scale_by_max)) -> temp_summary_percent
temp_DHW_summary
#bind all DHWs
max_DHW_alltypes %>%
filter(site != "CCC_SST_19812012" & site != "Nursery_SST_19812012") %>%
cbind(temp.summary, .)  -> temp_DHW_summary
temp_DHW_summary
temp_DHW_summary %>%
select(!c(5))
temp_DHW_summary %>%
select(!c(5)) -> temp_DHW_summary
write_csv(temp_DHW_summary, "temp_DHW_summary.csv")
temp_DHW_summary %>%
column_to_rownames(var="site") -> temp_DHW_summary
colnames(temp_DHW_summary) <- c("Max", "Min", "Seasonal", "DHW")
temp_DHW_summary
temp_DHW_summary %>%
dplyr::mutate(across(everything(), as.numeric)) %>%
dplyr::mutate(across(everything(), scale_by_max)) -> temp_summary_percent
# To use the fmsb package, I have to add 2 lines to the dataframe: the max and min of each variable to show on the plot!
temp_summary_percent <- rbind(rep(100,5), rep(0,5), temp_summary_percent)
temp_summary_percent
colors_border=c("yellow", "lightblue", "orange", "darkblue")
colors_in=c("yellow", "lightblue","orange", "darkblue")
colors_border <- c(adjustcolor("yellow", alpha = 0.9), adjustcolor("lightblue", alpha = 0.9), adjustcolor("orange", alpha = 0.9), adjustcolor("darkblue", alpha = 0.9))
colors_in <- c(adjustcolor("yellow", alpha = 0.4), adjustcolor("lightblue", alpha = 0.4), adjustcolor("orange", alpha = 0.4), adjustcolor("darkblue", alpha = 0.4))
library(fmsb)
pdf("radarchart_SST_initu.pdf")
radarchart(temp_summary_percent, axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,100,25), cglwd=0.8,
#custom labels
vlcex=0.9
)
dev.off()
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
filter(as.Date(Datetime_EST) < "2021-12-01" & as.Date(Datetime_EST) > "2021-06-20") %>%
ggplot(., aes(x=Datetime_EST, y=Temperature, color = site)) +
geom_line() +
theme_bw() +
labs(x="Date", y = "Temp (ºC)") +
scale_color_manual(values = c("CURES_tilt" = "orange", "Nursery" = "darkblue")) +
geom_hline(yintercept = 29.54, linetype = "dashed", color = "grey") +
geom_hline(yintercept = 30.49, linetype = "dashed", color = "darkblue") +
geom_hline(yintercept = 30.51, linetype = "dashed", color = "orange") +
geom_hline(yintercept = 30.54, linetype = "dashed", color = "grey") +
geom_hline(yintercept = 31.49, linetype = "dashed", color = "darkblue") +
geom_hline(yintercept = 31.51, linetype = "dashed", color = "orange") +
geom_hline(yintercept = 30.04, linetype = "dashed", color = "lightblue") +
geom_hline(yintercept = 31.04, linetype = "dashed", color = "lightblue") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 1, y = 29.3, label = "SST 1981-2012 MMM", hjust = 1.1, color = "grey") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 1, y = 30.2, label = "Nursery HOBO MMM", hjust = 1.1, color = "darkblue") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 1, y = 30.7, label = "CCC Tilt MMM", hjust = 1.1, color = "orange") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 1, y = 30.4, label = "1981-2012 SST bleaching threshold", hjust = 1.1, color = "grey") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 1, y = 31.3, label = "Nursery bleaching threshold", hjust = 1.1, color = "darkblue") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 1, y = 31.7, label = "CCC bleaching theshold", hjust = 1.1, color = "orange") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 2, y = 29.9, label = "SST 2020-2021 MMM", hjust = 1.1, color = "lightblue") +
annotate("text", x = max(filtered_KB_data_20202021$Datetime_EST) + 2, y = 30.9, label = "SST 2020-2021 bleaching threshold", hjust = 1.1, color = "lightblue")
rbind(Long.data.DHW.CCCinsitu, Long.data.DHW.nurseryinsitu) %>%
full_join(., Long.data.DHW.CCCSST) %>%
rbind(., Long.data.DHW.CCCSST_2021, Long.data.DHW.nurserySST, Long.data.DHW.nurserySST_2021) %>%
mutate(site = factor(site, levels = c("CCC_SST_19812012", "Nursery_SST_19812012", "CCC_SST_20202021", "CCC_insitu", "Nursery_SST_20202021", "Nursery_insitu"))) %>%
ggplot(., aes(x=ymd(Date), y=DHW, color = site)) +
geom_line() +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed") +
theme_bw()
ggsave("all_DHWs.pdf", width = 10, height = 7)
full_join(filtered_KB_data_20202021, cures_frame_tilt_temp) %>%
mutate(Date = as.Date(Datetime_EST)) %>%
full_join(., CRW_SST_2020_2021) %>%
group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!c(Datetime_EST, Month, Year, Temperature)) %>%
distinct() %>%
filter(Date < "2021-12-01" & Date > "2021-06-20") %>%
ggplot(., aes(x=Date, y=mean_daily_temp, color = site)) +
geom_line() +
theme_bw() +
labs(x="Date", y = "Mean Daily Temp (ºC)") +
scale_color_manual(values = c("CURES_tilt" = "orange", "Nursery" = "darkblue", "20202021_SST_Nursery" = "lightblue", "20202021_SST_CCC" = "aquamarine")) +
geom_hline(yintercept = 29.54, linetype = "dashed", color = "grey") +
geom_hline(yintercept = 30.49, linetype = "dashed", color = "darkblue") +
geom_hline(yintercept = 30.51, linetype = "dashed", color = "orange") +
geom_hline(yintercept = 30.04, linetype = "dashed", color = "lightblue") +
annotate("text", x = max(CRW_SST_2020_2021$Date) + 1, y = 29.3, label = "SST 1981-2012 MMM", hjust = 1.1, color = "grey") +
annotate("text", x = max(CRW_SST_2020_2021$Date) + 1, y = 30.3, label = "Nursery HOBO MMM", hjust = 1.1, color = "darkblue") +
annotate("text", x = max(CRW_SST_2020_2021$Date) + 1, y = 30.7, label = "CCC Tilt MMM", hjust = 1.1, color = "orange") +
annotate("text", x = max(CRW_SST_2020_2021$Date) + 2, y = 29.9, label = "SST 2020-2021 MMM", hjust = 1.1, color = "lightblue")
ggsave("CURES_nursery_SST_dailytemp_allMMMs.pdf", width=10, height = 7)
