mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7)
=7*12
7*12
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(DHW = rollapplyr(Weeks_Stress, list(-(83:0)), sum, fill = NA))) #7 days per week, 12 weeks of heat stress data = 84
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(DHW = rollapplyr(Weeks_Stress, list(-(83:0)), sum, fill = NA)) #7 days per week, 12 weeks of heat stress data = 84
library(zoo)
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(DHW = rollapplyr(Weeks_Stress, list(-(83:0)), sum, fill = NA)) #7 days per week, 12 weeks of heat stress data = 84
alldata_2020_2021_sep$DHW<-rollapplyr(alldata_2020_2021_sep$W_Stress,list(-(83:0)),sum)# Add 12 weeks of heat stress data
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(DHW = rollapplyr(Weeks_Stress, list(-(83:0)), sum)) #7 days per week, 12 weeks of heat stress data = 84
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7)
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
arrange(desc(Weeks_Stress))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(week_number = lubridate::week(lubridate::as.Date(Date)))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(week_number = lubridate::week(lubridate::asDate(Date)))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(week_number = lubridate::week(lubridate::ymd(Date)))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(week_number = lubridate::week(lubridate::ymd(Date))) %>%
mutate(week_group = ceiling(week_number / 12))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(date_column = seq(ymd(Date), by = "week", length.out = 52))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7)
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(week_number = lubridate::week(lubridate::ymd(Date))) %>%
mutate(week_group = ceiling(week_number / 12))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(
# Create a continuous week count across years
continuous_week = year(Date) * 52 + week(Date),
# Group into 12-week periods
week_group = ceiling(continuous_week / 12)
)
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(
# Create a continuous week count across years
continuous_week = year(Date) * 52 + week(Date),
# Group into 12-week periods
week_group = ceiling(continuous_week / 12)
) %>%
group_by(week_group, site) %>%
mutate(DHW = sum(Weeks_Stress))
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(
# Create a continuous week count across years
continuous_week = year(Date) * 52 + week(Date),
# Group into 12-week periods
week_group = ceiling(continuous_week / 12)
) %>%
group_by(week_group, site) %>%
mutate(DHW = sum(Weeks_Stress)) -> Long.data.DHW
# Plot data
AllSources<-ggplot(Long.data.DHW, aes(x=Date)) +
ggthe_bw+ theme(legend.position = "none")+
facet_wrap(~Source)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_line(aes(y = mean_daily_temp, colour = "mean_daily_temp")) +
geom_line(aes(y = DHW, colour = "DHW")) +
ylab("DWH (C-week)  /  Temperature (C)")
# Plot data
ggplot(Long.data.DHW, aes(x=Date)) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_line(aes(y = mean_daily_temp, colour = "mean_daily_temp")) +
geom_line(aes(y = DHW, colour = "DHW")) +
ylab("DWH (C-week)  /  Temperature (C)")
# Plot data
ggplot(Long.data.DHW, aes(x=Date)) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_point(aes(y = mean_daily_temp, colour = "mean_daily_temp")) +
geom_point(aes(y = DHW, colour = "DHW")) +
ylab("DWH (C-week)  /  Temperature (C)")
# Plot data
ggplot(Long.data.DHW, aes(x=Date)) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_point(aes(y = DHW, colour = "DHW")) +
ylab("DWH (C-week)  /  Temperature (C)")
# Plot data
ggplot(Long.data.DHW, aes(x=Date)) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_point(aes(y = DHW)) +
geom_line(aes(y = DHW)) +
ylab("DWH (C-week)  /  Temperature (C)")
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_point(aes(y = DHW)) +
geom_line(aes(y = DHW)) +
ylab("DWH (C-week)  /  Temperature (C)")
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_line(aes(y = DHW)) +
ylab("DWH (C-week)  /  Temperature (C)")
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_line(aes(y = DHW)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_bw()
Long.data.DHW
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(
# Create a continuous week count across years
continuous_week = year(Date) * 52 + week(Date),
# Group into 12-week periods
week_group = ceiling(continuous_week / 12)
) %>%
group_by(week_group, site) %>%
mutate(DHW = sum(Weeks_Stress)) %>%
pivot_longer(c(HotSpot:Weeks_Stress, DHW), names_to = "Field", values_to = "value")
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(
# Create a continuous week count across years
continuous_week = year(Date) * 52 + week(Date),
# Group into 12-week periods
week_group = ceiling(continuous_week / 12)
) %>%
group_by(week_group, site) %>%
mutate(DHW = sum(Weeks_Stress)) %>%
pivot_longer(c(HotSpot:Weeks_Stress, DHW), names_to = "Field", values_to = "value")-> Long.data.DHW
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
facet_wrap(~site)+
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_line(aes(y = value, color = Field)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_bw()
alldata_2020_2021_sep %>%
select(!c(Time, Season)) %>%
dplyr::group_by(Date, site) %>%
mutate(mean_daily_temp = mean(Temperature)) %>%
select(!Temperature) %>%
distinct() %>%
mutate(HotSpot = case_when(site == "Nursery" ~ (mean_daily_temp - 29.53),
site == "CURES" ~ (mean_daily_temp - 29.54))) %>%
mutate(HotSpot = ifelse(HotSpot >= 0, HotSpot, 0)) %>%
mutate(Stress = ifelse(HotSpot >= 1, HotSpot, 0)) %>%
mutate(Weeks_Stress = Stress/7) %>%
mutate(
# Create a continuous week count across years
continuous_week = year(Date) * 52 + week(Date),
# Group into 12-week periods
week_group = ceiling(continuous_week / 12)
) %>%
group_by(week_group, site) %>%
mutate(DHW = sum(Weeks_Stress)) -> Long.data.DHW
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed", color="red")+
geom_hline(yintercept=4, linetype="dashed", color="orange")+
geom_line(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
geom_hline(yintercept=8, linetype="dashed"+
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_col(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_col(aes(y = DHW, color = site, position = position_dodge())) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_col(aes(y = DHW, color = site), position = position_dodge()) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_bar(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_point(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
# Plot data
ggplot(Long.data.DHW, aes(x=ymd(Date))) +
geom_hline(yintercept=8, linetype="dashed")+
geom_hline(yintercept=4, linetype="dashed")+
geom_line(aes(y = DHW, color = site)) +
ylab("DWH (C-week)  /  Temperature (C)") +
xlab("Date") +
theme_classic() +
scale_color_manual(values = c("CURES" = "orange", "Nursery" = "darkblue"))
ggsave("DHW_linegraph.pdf")
Long.data.DHW
Long.data.DHW
# Highest DWH per year
MaxDHW<-as.data.frame(Long.data.DHW %>%
group_by(site, year(Date)) %>%
summarize(max = max(DHW, na.rm = TRUE)))
MaxDHW
MaxDHW %>%
filter(`year(Date)` == "2021")
MaxDHW %>%
filter(`year(Date)` == "2021") %>%
rename(DHW = max)
MaxDHW %>%
filter(`year(Date)` == "2021") %>%
rename(DHW = max) -> MaxDHW
temp_summary
ful_join(temp_summary, MaxDHW)
full_join(temp_summary, MaxDHW)
cross_join(temp_summary, MaxDHW)
cbind(temp_summary, MaxDHW)
cbind(temp_summary, MaxDHW) %>%
select(!`year(Date)`)
cbind(temp_summary, MaxDHW) %>%
select(!`year(Date)`) -> temp_DHW_summary
scale_by_max <- function(x) {
x * 100 / max(x, na.rm = TRUE)
}
temp_DHW_summary %>%
dplyr::mutate(across(everything(), as.numeric)) %>%
dplyr::mutate(across(everything(), scale_by_max)) -> temp_DHW_summary_percent
temp_DHW_summary
cbind(temp_summary, MaxDHW) %>%
select(!c(`year(Date)`,site)) -> temp_DHW_summary
temp_DHW_summary %>%
dplyr::mutate(across(everything(), as.numeric)) %>%
dplyr::mutate(across(everything(), scale_by_max)) -> temp_DHW_summary_percent
temp_DHW_summary_percent
# To use the fmsb package, I have to add 2 lines to the dataframe: the max and min of each variable to show on the plot!
temp_DHW_summary_percent <- rbind(rep(100,5), rep(0,5), temp_DHW_summary_percent)
colors_border=c("orange", "darkblue")
colors_in=c("orange", "darkblue")
# Define colors with transparency using adjustcolor
colors_border <- c(adjustcolor("orange", alpha = 0.9), adjustcolor("darkblue", alpha = 0.9))
colors_in <- c(adjustcolor("orange", alpha = 0.4), adjustcolor("darkblue", alpha = 0.4))
# plot with default options:
#pdf("radarchart_alldata_30_5.pdf")
radarchart(temp_DHW_summary_percent, axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,100,25), cglwd=0.8,
#custom labels
vlcex=0.9
)
library(fmsb)
# plot with default options:
#pdf("radarchart_alldata_30_5.pdf")
radarchart(temp_DHW_summary_percent, axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,100,25), cglwd=0.8,
#custom labels
vlcex=0.9
)
pdf("radarchart_withDHW.pdf")
radarchart(temp_DHW_summary_percent, axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,100,25), cglwd=0.8,
#custom labels
vlcex=0.9
)
View(MaxDHW)
write_csv(temp_DHW_summary, "temp_DHW_summary.csv")
