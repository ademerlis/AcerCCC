addLegend(position = "bottomright",
pal = pal.gen2,
values = ~Depth, opacity = 1) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = ~Lon, lat = ~Lat,
stroke = F,
radius = ~Size*2,
fillOpacity = 1,
color = ~pal.gen(Depth),
label = ~Depth,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))
dt_zoomedin <- data.frame(lon = c(-80.5, -80),
lat = c(25.5,26),
var = c("a", "b")
)
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addLegend(position = "bottomright",
pal = pal.gen2,
values = ~Depth, opacity = 1) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = ~Lon, lat = ~Lat,
stroke = F,
radius = ~Size*2,
fillOpacity = 1,
color = ~pal.gen(Depth),
label = ~Depth,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = ~Lon, lat = ~Lat,
stroke = F,
radius = ~Size*2,
fillOpacity = 1,
color = ~pal.gen(Depth),
label = ~Depth,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = ~lon, lat = ~lat,
stroke = F,
radius = ~Size*2,
fillOpacity = 1,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = ~lon, lat = ~lat,
stroke = F,
fillOpacity = 1,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))
map
map
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = ~lon, lat = ~lat,
stroke = F,
fillOpacity = 1,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))   %>%
setView(lng = -80.1918, lat = 25.7617, zoom = 10)
map
if (!requireNamespace("webshot", quietly = TRUE)) install.packages("webshot")
install.packages("webshot")
install.packages("webshot")
library(webshot)
webshot::install_phantomjs()
webshot::webshot(url = map@dependencies$htmlwidgets$htmlwidget_dependencies[[1]]$src, file = "map.png")
map
saveWidget(mao, "miami_map.html", selfcontained = TRUE)
saveWidget(map, "miami_map.html", selfcontained = TRUE)
library(htmlwidgets)
saveWidget(map, "miami_map.html", selfcontained = TRUE)
webshot::webshot(url = map@dependencies$htmlwidgets$htmlwidget_dependencies[[1]]$src, file = "map.png")
webshot("miami_map.html", "miami_map.pdf")
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 20) %>%   # Size of the marker
addCircleMarkers(lng = -80.144812, lat = 25.766626,
stroke = F,
fillOpacity = 1,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))  %>%
# Sub_regions
addRectangles(
lng1=-80.144812, lat1=25.766626,
lng2=-80.144812, lat2=25.766626,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Coral City Camera",
labelOptions = labelOptions(
noHide = T, direction = "top",
offset = c(0, 0),
textOnly = F)) %>%
addRectangles(
lng1=-80.0987, lat1=25.6763,
lng2=-80.0987, lat2=25.6763,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Key Biscayne Nursery",
labelOptions = labelOptions(
noHide = T, direction = "bottom",
offset = c(0, 0),
textOnly = F))
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 20) %>%   # Size of the marker
addCircleMarkers(lng = -80.144812, lat = 25.766626,
stroke = F,
fillOpacity = 1,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))  %>%
# Sub_regions
leaflet::addRectangles(
lng1=-80.144812, lat1=25.766626,
lng2=-80.144812, lat2=25.766626,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Coral City Camera",
labelOptions = labelOptions(
noHide = T, direction = "top",
offset = c(0, 0),
textOnly = F)) %>%
leaflet::addRectangles(
lng1=-80.0987, lat1=25.6763,
lng2=-80.0987, lat2=25.6763,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Key Biscayne Nursery",
labelOptions = labelOptions(
noHide = T, direction = "bottom",
offset = c(0, 0),
textOnly = F))
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 20) %>%   # Size of the marker
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
stroke = F,
fillOpacity = 1,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))  %>%
# Sub_regions
leaflet::addRectangles(
lng1=-80.144812, lat1=25.766626,
lng2=-80.144812, lat2=25.766626,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Coral City Camera",
labelOptions = labelOptions(
noHide = T, direction = "top",
offset = c(0, 0),
textOnly = F)) %>%
leaflet::addRectangles(
lng1=-80.0987, lat1=25.6763,
lng2=-80.0987, lat2=25.6763,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Key Biscayne Nursery",
labelOptions = labelOptions(
noHide = T, direction = "bottom",
offset = c(0, 0),
textOnly = F))
leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 20)
library(leaflet)
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 20) %>%   # Size of the marker
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
stroke = F,
fillOpacity = 1,
labelOptions = labelOptions(
noHide = F,
textOnly = TRUE,
style = list(
"color" = "black")))  %>%
# Sub_regions
leaflet::addRectangles(
lng1=-80.144812, lat1=25.766626,
lng2=-80.144812, lat2=25.766626,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Coral City Camera",
labelOptions = labelOptions(
noHide = T, direction = "top",
offset = c(0, 0),
textOnly = F)) %>%
leaflet::addRectangles(
lng1=-80.0987, lat1=25.6763,
lng2=-80.0987, lat2=25.6763,
opacity = 1,
color = "gray",
#color = "#F8766D",
weight=2,
fillColor = "transparent",
label = "Key Biscayne Nursery",
labelOptions = labelOptions(
noHide = T, direction = "bottom",
offset = c(0, 0),
textOnly = F))
map
map
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 20) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 20)
map
map<-leaflet(dt_zoomedin, width = '800px') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
saveWidget(map, "ch2_map.html", selfcontained = TRUE)
webshot("miami_map.html", "miami_map.pdf")
map
saveWidget(map, "ch2_map.html", selfcontained = TRUE)
webshot("miami_map.html", "miami_map.pdf")
webshot("ch2_map.html", "ch2_map.pdf")
map<-leaflet(dt_zoomedin, width = '200') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-83, lat=24, lng2=-79, lat2=30)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
saveWidget(map, "florid.html", selfcontained = TRUE)
webshot("florid.html", "florida.pdf")
map<-leaflet(dt_zoomedin, width = '600') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.5, lat=25.5, lng2=-80, lat2=26)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '600') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.5, lng2=-80, lat2=25.8)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.5, lng2=-80, lat2=25.8)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.5, lng2=-80, lat2=25.78)%>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.5, lng2=-80, lat2=25.78)%>%
setView(lng = -80.2, lat = 25.5, zoom = 15) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.5, lng2=-80, lat2=25.78)%>%
setView(lng = -80.0987, lat = 25.6763, zoom = 10) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.5, lng2=-80, lat2=25.78)%>%
setView(lng = -80.0987, lat = 25.6763, zoom = 12) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.5, lng2=-80, lat2=25.78)%>%
setView(lng = -80.0987, lat = 25.6763, zoom = 11) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.4, lng2=-80, lat2=25.77)%>%
setView(lng = -80.0987, lat = 25.6763, zoom = 11) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.3, lng2=-80, lat2=25.77)%>%
setView(lng = -80.0987, lat = 25.6763, zoom = 11) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.4, lng2=-80, lat2=25.77)%>%
setView(lng = -80.144812, lat = 25.766626, zoom = 11) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.4, lng2=-80, lat2=25.77)%>%
setView(lng = -80.144812, lat = 25.766626, zoom = 12) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
map<-leaflet(dt_zoomedin, width = '300') %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldGrayCanvas) %>%
addScaleBar(position = "topright") %>%
fitBounds(lng1=-80.2, lat=25.4, lng2=-80, lat2=25.77)%>%
setView(lng = -80.144812, lat = 25.766626, zoom = 11) %>%
leaflet::addCircleMarkers(lng = -80.0987, lat =  25.6763,
radius = 5) %>%
leaflet::addCircleMarkers(lng = -80.144812, lat = 25.766626,
radius = 5)
map
saveWidget(map, "port.html", selfcontained = TRUE)
webshot("port.html", "port.pdf")
library(tidyverse)
library(DESeq2)
library(cowplot)
load("Rdata_files/initial_fullddsdesigncountsVsdcounts.RData")
load("Rdata_files/realModels_Acer.RData")
KEGG_genes <- read_csv("results/KEGG_CvN_results_withgenes.csv")
dds <- estimateSizeFactors(dds)
normalized_counts <- counts(dds, normalized=TRUE)
resLFC <- lfcShrink(dds, coef="Location_CCC_vs_nursery", type="apeglm")
normalized_counts %>%
as.data.frame() %>%
rownames_to_column(var="gene") -> normalized_counts
design %>%
rownames_to_column(var="Sample_ID") -> design
KEGG_genes %>%
dplyr::select(ID, Description, Category, KO, gene, annot) %>%
left_join(., normalized_counts, by = "gene") %>%  #151 genes
pivot_longer(Acer_1089:Acer_2384, names_to="Sample_ID", values_to="norm_expression") %>%
full_join(., design, by = "Sample_ID") -> KEGG_genes_normcounts
resLFC %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::select(gene, log2FoldChange) -> genes_l2fc
genes_l2fc
KEGG_genes_normcounts %>%
right_join(., genes_l2fc, by="gene") -> KEGG_genes_normcounts_l2fc
KEGG_genes_normcounts_l2fc
gene_annot <- read.table(file="bioinformatics/Acervicornis_iso2geneName.tab", sep = "\t", quote="", fill=FALSE)
gene_annot %>%
dplyr::rename(gene = V1, annot=V2) -> gene_annot
gene_annot %>%
filter(gene == "Acropora_006280")
resLFC %>%
as.data.frame() %>%
rownames_to_column(var="gene")
resLFC %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
filter(gene == "Acropora_006280")
resLFC %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
filter(gene == "Acropora_000581")
